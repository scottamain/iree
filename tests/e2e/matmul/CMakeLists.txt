################################################################################
# Autogenerated by build_tools/bazel_to_cmake/bazel_to_cmake.py from           #
# tests/e2e/matmul/BUILD                                                       #
#                                                                              #
# Use iree_cmake_extra_content from iree/build_defs.oss.bzl to add arbitrary   #
# CMake-only content.                                                          #
#                                                                              #
# To disable autogeneration for this file entirely, delete this header.        #
################################################################################

iree_add_all_subdirs()

iree_generated_trace_runner_test(
  NAME
    e2e_matmul_direct_i8_small
  GENERATOR
    "generate_e2e_matmul_tests.py"
  GENERATOR_ARGS
    "--lhs_rhs_type=i8"
    "--shapes=small"
  TRACE_RUNNER
    iree-e2e-matmul-test
  TARGET_BACKENDS
    "llvm-cpu"
  DRIVERS
    "local-task"
)

iree_generated_trace_runner_test(
  NAME
    e2e_matmul_direct_f32_small
  GENERATOR
    "generate_e2e_matmul_tests.py"
  GENERATOR_ARGS
    "--lhs_rhs_type=f32"
    "--shapes=small"
  TRACE_RUNNER
    iree-e2e-matmul-test
  TARGET_BACKENDS
    "llvm-cpu"
  DRIVERS
    "local-task"
)

iree_generated_trace_runner_test(
  NAME
    e2e_matmul_mmt4d_i8_small
  GENERATOR
    "generate_e2e_matmul_tests.py"
  GENERATOR_ARGS
    "--lhs_rhs_type=i8"
    "--shapes=small"
  TRACE_RUNNER
    iree-e2e-matmul-test
  TARGET_BACKENDS
    "llvm-cpu"
  DRIVERS
    "local-task"
  COMPILER_FLAGS
    "--iree-flow-enable-data-tiling"
  TARGET_CPU_FEATURES_VARIANTS
    "default"
    "aarch64:+dotprod"
    "aarch64:+i8mm"
)

iree_generated_trace_runner_test(
  NAME
    e2e_matmul_mmt4d_f32_small
  GENERATOR
    "generate_e2e_matmul_tests.py"
  GENERATOR_ARGS
    "--lhs_rhs_type=f32"
    "--shapes=small"
  TRACE_RUNNER
    iree-e2e-matmul-test
  TARGET_BACKENDS
    "llvm-cpu"
  DRIVERS
    "local-task"
  COMPILER_FLAGS
    "--iree-flow-enable-data-tiling"
  TARGET_CPU_FEATURES_VARIANTS
    "default"
)

iree_generated_trace_runner_test(
  NAME
    e2e_matmul_mmt4d_i8_large
  GENERATOR
    "generate_e2e_matmul_tests.py"
  GENERATOR_ARGS
    "--lhs_rhs_type=i8"
    "--shapes=large"
  TRACE_RUNNER
    iree-e2e-matmul-test
  TARGET_BACKENDS
    "llvm-cpu"
  DRIVERS
    "local-task"
  COMPILER_FLAGS
    "--iree-flow-enable-data-tiling"
  TARGET_CPU_FEATURES_VARIANTS
    "default"
    "aarch64:+dotprod"
    "aarch64:+i8mm"
)

iree_generated_trace_runner_test(
  NAME
    e2e_matmul_mmt4d_f32_large
  GENERATOR
    "generate_e2e_matmul_tests.py"
  GENERATOR_ARGS
    "--lhs_rhs_type=f32"
    "--shapes=large"
  TRACE_RUNNER
    iree-e2e-matmul-test
  TARGET_BACKENDS
    "llvm-cpu"
  DRIVERS
    "local-task"
  COMPILER_FLAGS
    "--iree-flow-enable-data-tiling"
  TARGET_CPU_FEATURES_VARIANTS
    "default"
)

iree_generated_trace_runner_test(
  NAME
    e2e_matmul_mmt4d_i8_intrinsics_small
  GENERATOR
    "generate_e2e_matmul_tests.py"
  GENERATOR_ARGS
    "--lhs_rhs_type=i8"
    "--shapes=small"
  TRACE_RUNNER
    iree-e2e-matmul-test
  TARGET_BACKENDS
    "llvm-cpu"
  DRIVERS
    "local-task"
  COMPILER_FLAGS
    "--iree-codegen-mmt4d-use-intrinsics"
    "--iree-flow-enable-data-tiling"
  TARGET_CPU_FEATURES_VARIANTS
    "default"
    "aarch64:+dotprod"
    "aarch64:+i8mm"
)

iree_generated_trace_runner_test(
  NAME
    e2e_matmul_mmt4d_f32_intrinsics_small
  GENERATOR
    "generate_e2e_matmul_tests.py"
  GENERATOR_ARGS
    "--lhs_rhs_type=f32"
    "--shapes=small"
  TRACE_RUNNER
    iree-e2e-matmul-test
  TARGET_BACKENDS
    "llvm-cpu"
  DRIVERS
    "local-task"
  COMPILER_FLAGS
    "--iree-codegen-mmt4d-use-intrinsics"
    "--iree-flow-enable-data-tiling"
  TARGET_CPU_FEATURES_VARIANTS
    "default"
)

iree_generated_trace_runner_test(
  NAME
    e2e_matmul_direct_i8_small_ukernel
  GENERATOR
    "generate_e2e_matmul_tests.py"
  GENERATOR_ARGS
    "--lhs_rhs_type=i8"
    "--shapes=small"
  TRACE_RUNNER
    iree-e2e-matmul-test
  TARGET_BACKENDS
    "vmvx"
  DRIVERS
    "local-task"
  COMPILER_FLAGS
    "--iree-vmvx-enable-microkernels"
)

iree_generated_trace_runner_test(
  NAME
    e2e_matmul_direct_f32_small_ukernel
  GENERATOR
    "generate_e2e_matmul_tests.py"
  GENERATOR_ARGS
    "--lhs_rhs_type=f32"
    "--shapes=small"
  TRACE_RUNNER
    iree-e2e-matmul-test
  TARGET_BACKENDS
    "vmvx"
  DRIVERS
    "local-task"
  COMPILER_FLAGS
    "--iree-vmvx-enable-microkernels"
)

iree_generated_trace_runner_test(
  NAME
    e2e_matmul_mmt4d_i8_small_ukernel
  GENERATOR
    "generate_e2e_matmul_tests.py"
  GENERATOR_ARGS
    "--lhs_rhs_type=i8"
    "--shapes=small"
  TRACE_RUNNER
    iree-e2e-matmul-test
  TARGET_BACKENDS
    "vmvx"
  DRIVERS
    "local-task"
  COMPILER_FLAGS
    "--iree-vmvx-enable-microkernels"
    "--iree-flow-enable-data-tiling"
)

iree_generated_trace_runner_test(
  NAME
    e2e_matmul_mmt4d_f32_small_ukernel
  GENERATOR
    "generate_e2e_matmul_tests.py"
  GENERATOR_ARGS
    "--lhs_rhs_type=f32"
    "--shapes=small"
  TRACE_RUNNER
    iree-e2e-matmul-test
  TARGET_BACKENDS
    "vmvx"
  DRIVERS
    "local-task"
  COMPILER_FLAGS
    "--iree-vmvx-enable-microkernels"
    "--iree-flow-enable-data-tiling"
)

iree_generated_trace_runner_test(
  NAME
    e2e_matmul_direct_f32_gpu_large_LLVMGPUMatmulSimt
  GENERATOR
    "generate_e2e_matmul_tests.py"
  GENERATOR_ARGS
    "--lhs_rhs_type=f32"
    "--shapes=gpu_large"
    "--compilation_info=LLVMGPUMatmulSimt"
  TRACE_RUNNER
    iree-e2e-matmul-test
  TARGET_BACKENDS
    "cuda"
  DRIVERS
    "cuda"
  LABELS
    "noasan"
    "nomsan"
    "notsan"
    "noubsan"
    "requires-gpu-nvidia"
)

iree_generated_trace_runner_test(
  NAME
    e2e_matmul_direct_f32_gpu_large_LLVMGPUMatmulTensorCore
  GENERATOR
    "generate_e2e_matmul_tests.py"
  GENERATOR_ARGS
    "--lhs_rhs_type=f32"
    "--shapes=gpu_large"
    "--compilation_info=LLVMGPUMatmulTensorCore"
  TRACE_RUNNER
    iree-e2e-matmul-test
  TARGET_BACKENDS
    "cuda"
  DRIVERS
    "cuda"
  COMPILER_FLAGS
    "--iree-hal-cuda-llvm-target-arch=sm_80"
  LABELS
    "noasan"
    "nomsan"
    "notsan"
    "noubsan"
    "requires-gpu-nvidia"
)

iree_generated_trace_runner_test(
  NAME
    e2e_matmul_direct_f32_gpu_large_mma_sync_LLVMGPUMatmulTensorCore
  GENERATOR
    "generate_e2e_matmul_tests.py"
  GENERATOR_ARGS
    "--lhs_rhs_type=f32"
    "--shapes=gpu_large"
    "--compilation_info=LLVMGPUMatmulTensorCore"
  TRACE_RUNNER
    iree-e2e-matmul-test
  TARGET_BACKENDS
    "cuda"
  DRIVERS
    "cuda"
  COMPILER_FLAGS
    "--iree-hal-cuda-llvm-target-arch=sm_80"
    "--iree-codegen-llvmgpu-use-mma-sync=true"
  LABELS
    "noasan"
    "nomsan"
    "notsan"
    "noubsan"
    "requires-gpu-nvidia"
)

iree_generated_trace_runner_test(
  NAME
    e2e_matmul_direct_f16_gpu_large_LLVMGPUMatmulTensorCore
  GENERATOR
    "generate_e2e_matmul_tests.py"
  GENERATOR_ARGS
    "--lhs_rhs_type=f16"
    "--shapes=gpu_large"
    "--compilation_info=LLVMGPUMatmulTensorCore"
  TRACE_RUNNER
    iree-e2e-matmul-test
  TARGET_BACKENDS
    "cuda"
  DRIVERS
    "cuda"
  COMPILER_FLAGS
    "--iree-hal-cuda-llvm-target-arch=sm_80"
  LABELS
    "noasan"
    "nomsan"
    "notsan"
    "noubsan"
    "requires-gpu-nvidia"
)

iree_generated_trace_runner_test(
  NAME
    e2e_matmul_direct_f16_gpu_large_mma_sync_LLVMGPUMatmulTensorCore
  GENERATOR
    "generate_e2e_matmul_tests.py"
  GENERATOR_ARGS
    "--lhs_rhs_type=f16"
    "--shapes=gpu_large"
    "--compilation_info=LLVMGPUMatmulTensorCore"
  TRACE_RUNNER
    iree-e2e-matmul-test
  TARGET_BACKENDS
    "cuda"
  DRIVERS
    "cuda"
  COMPILER_FLAGS
    "--iree-hal-cuda-llvm-target-arch=sm_80"
    "--iree-codegen-llvmgpu-use-mma-sync=true"
  LABELS
    "noasan"
    "nomsan"
    "notsan"
    "noubsan"
    "requires-gpu-nvidia"
)

iree_generated_trace_runner_test(
  NAME
    e2e_matmul_direct_f32_large_split_k
  GENERATOR
    "generate_e2e_matmul_tests.py"
  GENERATOR_ARGS
    "--lhs_rhs_type=f32"
    "--shapes=large"
  TRACE_RUNNER
    iree-e2e-matmul-test
  TARGET_BACKENDS
    "cuda"
    "llvm-cpu"
  DRIVERS
    "cuda"
    "local-task"
  COMPILER_FLAGS
    "--iree-flow-split-matmul-reduction=4"
  LABELS
    "noasan"
    "nomsan"
    "notsan"
    "noubsan"
    "requires-gpu-nvidia"
)

iree_generated_trace_runner_test(
  NAME
    e2e_matmul_direct_f32_gpu_large_valhall-unknown-android31
  GENERATOR
    "generate_e2e_matmul_tests.py"
  GENERATOR_ARGS
    "--lhs_rhs_type=f32"
    "--shapes=gpu_large"
    "--compilation_info=SPIRVVectorizeMali"
  TRACE_RUNNER
    iree-e2e-matmul-test
  TARGET_BACKENDS
    "vulkan-spirv"
  DRIVERS
    "vulkan"
  COMPILER_FLAGS
    "--iree-vulkan-target-triple=valhall-unknown-android31"
  LABELS
    "requires-gpu-nvidia"
)

iree_generated_trace_runner_test(
  NAME
    e2e_matmul_direct_f32_gpu_large_ampere-unknown-linux
  GENERATOR
    "generate_e2e_matmul_tests.py"
  GENERATOR_ARGS
    "--lhs_rhs_type=f32"
    "--shapes=gpu_large"
    "--compilation_info=SPIRVVectorizeNVIDIA"
  TRACE_RUNNER
    iree-e2e-matmul-test
  TARGET_BACKENDS
    "vulkan-spirv"
  DRIVERS
    "vulkan"
  COMPILER_FLAGS
    "--iree-vulkan-target-triple=ampere-unknown-linux"
  LABELS
    "requires-gpu-nvidia"
)

iree_check_single_backend_test_suite(
  NAME
    check_cuda
  SRCS
    "large_linalg_matmul.mlir"
  TARGET_BACKEND
    "cuda"
  DRIVER
    "cuda"
  LABELS
    "noasan"
    "nomsan"
    "notsan"
    "noubsan"
    "requires-gpu-nvidia"
)

iree_generated_trace_runner_test(
  NAME
    e2e_matmul_direct_f32_small_no_padding
  GENERATOR
    "generate_e2e_matmul_tests.py"
  GENERATOR_ARGS
    "--lhs_rhs_type=f32"
    "--shapes=small"
  TRACE_RUNNER
    iree-e2e-matmul-test
  TARGET_BACKENDS
    "llvm-cpu"
  DRIVERS
    "local-task"
  COMPILER_FLAGS
    "--iree-codegen-enable-vector-padding=false"
)

### BAZEL_TO_CMAKE_PRESERVES_ALL_CONTENT_BELOW_THIS_LINE ###
